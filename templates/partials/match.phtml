<?php 

if (isset($match)) { 

    $t1Id = (int)$match->getTeam1();
    $t2Id = (int)$match->getTeam2();
    
    $logo1 = isset($teams[$t1Id]) ? $teams[$t1Id]->getLogo() : '';
    $logo2 = isset($teams[$t2Id]) ? $teams[$t2Id]->getLogo() : '';
?>
    
    <section class="match-detail-container">
        
        <h2 class="match-versus-title"><?= $match->getName() ?></h2>
        
        <div class="match-date-large"><?= $match->getDate() ?></div>

        <?php 
            $winnerId = (int)$match->getWinner();
            $team1Id  = (int)$match->getTeam1();
            $team2Id  = (int)$match->getTeam2();

            $classTeam1 = '';
            $classTeam2 = '';
            if ($winnerId !== 0) {
                if ($winnerId === $team1Id) {
                    $classTeam1 = 'winner';
                } elseif ($winnerId === $team2Id) {
                    $classTeam2 = 'winner';
                }
            }
        ?>
        <div class="versus-logos">
            <?php if ($logo1) { ?>
                <img class="big-logo <?= $classTeam1 ?>" src="<?= $logo1 ?>" alt="Team 1">
            <?php } ?>
            
            <?php if ($logo2) { ?>
                <img class="big-logo <?= $classTeam2 ?>" src="<?= $logo2 ?>" alt="Team 2">
            <?php } ?>
        </div>

        <h3 class="perf-section-title">LES PERFORMANCES</h3>

        <table class="match-stats-table">
            <thead>
                <tr>
                    <th>PLAYER</th>
                    <th>TEAM</th>
                    <th>POINTS</th>
                    <th>ASSISTS</th>
                </tr>
            </thead>
            <tbody>
                <?php if (isset($stats) && !empty($stats)) { 
                    foreach ($stats as $stat) { ?>
                    <tr>
                        <td class="col-pink"><?= $stat['nickname'] ?></td>
                        
                        <td class="col-yellow"><?= $stat['team_name'] ?></td>
                        
                        <td class="col-white"><?= $stat['points'] ?></td>
                        <td class="col-white"><?= $stat['assists'] ?></td>
                    </tr>
                    <?php } 
                } else { ?>
                    <tr>
                        <td colspan="4" style="color: grey; padding: 20px;">Aucune stat disponible.</td>
                    </tr>
                <?php } ?>
            </tbody>
        </table>

    </section>

<?php 
} 

else { 
?>
    <section class="matchs">
        <div class="match_contenue">
            <h2>LES MATCHS</h2>
            
            <?php if (isset($data['matches'])) { ?>
                <?php foreach($data['matches'] as $game) { ?>
                    
                    <?php 
                        $winnerId = (int)$game->getWinner();
                        $team1Id  = (int)$game->getTeam1();
                        $team2Id  = (int)$game->getTeam2();

                        $classTeam1 = '';
                        $classTeam2 = '';
                        if ($winnerId !== 0) {
                            if ($winnerId === $team1Id) {
                                $classTeam1 = 'winner';
                            } elseif ($winnerId === $team2Id) {
                                $classTeam2 = 'winner';
                            }
                        }
                    ?>

                    <div class="match">
                        <h3><?= $game->getName() ?></h3>
                        <p><?= $game->getDate() ?></p>
                        
                        <div class="match_img">
                            <?php if (isset($teams[$team1Id])) { ?>
                                <img src="<?= $teams[$team1Id]->getLogo() ?>" 
                                     alt="Team 1" 
                                     class="<?= $classTeam1 ?>">
                            <?php } ?>
                        
                            <span class="vs">VS</span>

                            <?php if (isset($teams[$team2Id])) { ?>
                                <img src="<?= $teams[$team2Id]->getLogo() ?>" 
                                     alt="Team 2" 
                                     class="<?= $classTeam2 ?>">
                            <?php } ?>
                        </div>
                        
                        <a href="index.php?route=match&id=<?= $game->getId() ?>" class="button_detail">
                            <button type="button">DÃ©tails du match</button>
                        </a>
                        
                    </div>
                <?php } ?>
            <?php } ?>
        </div>
    </section>
<?php 
} 
?>
